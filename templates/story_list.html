{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container" style="max-width: 900px; margin: 2rem auto;">
    {% if messages %}
        <div>
            {% for message in messages %}
                <div style="padding:10px; margin-bottom:8px; border:1px solid #ddd; border-left:4px solid #4caf50;">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <h1>Inspirational Stories</h1>
    <p>Read real stories from our community. Share yours below!</p>

    <!-- Approved stories -->
    <section style="margin-top: 1.5rem;">
        <h2>Pre-existing Stories</h2>
        {% if stories %}
            <ul style="list-style:none; padding:0;">
                {% for s in stories %}
                    <li style="border:1px solid #eee; border-radius:12px; padding:16px; margin-bottom:12px;">
                        <h3 style="margin:0 0 6px 0;">{{ s.title }}</h3>
                        <small>
                            {% if s.author_name %}by {{ s.author_name }}, {% endif %}
                            {{ s.created_at|date:'M d, Y' }}
                        </small>
                        {% if s.cover %}
                            <div style="margin:10px 0;">
                                <img src="{{ s.cover.url }}" alt="{{ s.title }}" style="max-width:100%; height:auto; border-radius:8px;">
                            </div>
                        {% endif %}
                        <p style="white-space:pre-line;">{{ s.body }}</p>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No stories yet. Be the first to share!</p>
        {% endif %}
    </section>

    <!-- Submission form -->
    <section style="margin-top: 2rem;">
        <h2>Share Your Story</h2>
        <form method="post" enctype="multipart/form-data" style="display:grid; gap:12px;">
            {% csrf_token %}
            <div>
                <label for="id_title">Title</label>
                {{ form.title }}
            </div>
            <div>
                <label for="id_author_name">Your Name (optional)</label>
                {{ form.author_name }}
            </div>
            <div>
                <label for="id_body">Your Story</label>
                {{ form.body }}
            </div>
            <div>
                <label for="id_cover">Image (optional)</label>
                {{ form.cover }}
            </div>
            <button type="submit" style="padding:10px 14px; border-radius:8px; border:0; background:#4caf50; color:white; cursor:pointer;">
                Submit Story
            </button>
        </form>
        <p style="font-size:0.9rem; color:#666; margin-top:6px;">
            Submissions are reviewed by an admin before they appear.
        </p>
    </section>
</div>
{% endblock %}
